{% load static %}

<style>
/* Card hover effect */
.card-hover {
    background-color: #f5f5f5; /* Smoke color */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card-hover:hover {
    transform: translateY(-8px); /* Lift card slightly */
    box-shadow: 0 8px 20px rgba(0,0,0,0.2); /* Bigger shadow */
}
</style>

<div class="container-fluid mt-4">

  <!-- Summary Cards Row -->
  <div class="row g-4 mb-4">
    <div class="col-md-4">
      <div class="card text-center shadow-sm h-100 card-hover">
        <div class="card-body">
          <h5 class="card-title">Booking Properties</h5>
          <p class="display-6">{{ booking_count }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm h-100 card-hover">
        <div class="card-body">
          <h5 class="card-title">Residence Properties</h5>
          <p class="display-6">{{ residence_count }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm h-100 card-hover">
        <div class="card-body">
          <h5 class="card-title">Car Rental Properties</h5>
          <p class="display-6">{{ car_rental_count }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row g-4 mb-4">
    <!-- Doughnut Chart -->
    <div class="col-md-6">
      <div class="card shadow-sm h-100 p-3 text-center card-hover">
        <h5 class="card-title">Residence Properties Status</h5>
        <div style="max-width: 350px; margin: auto;">
          <canvas id="propertyStatusChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Recent Properties -->
    <div class="col-md-6">
      <div class="card shadow-sm h-100 p-3 card-hover">
        <h5 class="card-title">Recent Properties</h5>
        <div class="list-group list-group-flush">
          {% for property in residence_properties %}
          <div class="list-group-item d-flex justify-content-between align-items-center">
            <span>{{ property.property_name }}</span>
            {% if property.status == 'open' %}
              <span class="badge bg-success">{{ property.status|title }}</span>
            {% elif property.status == 'hold' %}
              <span class="badge bg-warning">{{ property.status|title }}</span>
            {% else %}
              <span class="badge bg-danger">{{ property.status|title }}</span>
            {% endif %}
          </div>
          <small class="text-muted ps-3">Date added: {{ property.created_at|date:"d/m/Y" }}</small>
          {% empty %}
          <div class="list-group-item">
            No properties found.
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('propertyStatusChart').getContext('2d');
new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: ['Open', 'Hold', 'Closed'],
        datasets: [{
            data: [{{ available_count }}, {{ hold_count }}, {{ closed_count }}],
            backgroundColor: ['#198754', '#ffc107', '#dc3545']
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: {
                position: 'bottom',
                labels: { padding: 20, boxWidth: 20 }
            }
        }
    }
});
</script>
