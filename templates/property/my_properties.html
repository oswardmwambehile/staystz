{% extends "property/base.html" %}
{% load static %}

{% block content %}
  {% include "property/sidebar.html" %}
  <div class="main-panel">
    <div class="main-header">
      <div class="main-header-logo">
        <div class="logo-header" data-background-color="dark">
          <a href="index.html" class="logo">
            <img
              src="{% static 'customer/img/logo.png' %}"
              alt="navbar brand"
              class="navbar-brand"
              height="20"
            />
          </a>
          <div class="nav-toggle">
            <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button>
            <button class="btn btn-toggle sidenav-toggler"><i class="gg-menu-left"></i></button>
          </div>
          <button class="topbar-toggler more"><i class="gg-more-vertical-alt"></i></button>
        </div>
      </div>
      {% include "property/nav.html" %}
    </div>

    <div class="container">
      <div class="page-inner">
        <div class="d-flex align-items-left align-items-md-center flex-column flex-md-row pt-2 pb-4">
          <div></div>
        </div>

        <h2 class="mb-4">My Properties</h2>

        <div class="table-responsive">
          <table class="table table-hover align-middle table-transparent">
            <thead class="text-uppercase text-secondary small">
              <tr>
                <th>Property Name</th>
                <th>Property Type</th>
                <th>District</th>
                <th>Region</th>
                <th>Country</th>
                <th>Created At</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for property in properties %}
              <tr class="align-middle">
                <td class="fw-bold">{{ property.property_name }}</td>
                <td>{{ property.property_type|title }}</td>
                <td>{{ property.district }}</td>
                <td>{{ property.region }}</td>
                <td>{{ property.country }}</td>
                <td>{{ property.created_at|date:"Y-m-d H:i" }}</td>
                <td class="d-flex gap-1">
                  <a href="{% url 'property_detail' property.id %}" class="btn btn-sm btn-primary">
                    <i class="bi bi-eye"></i>
                  </a>

                  <!-- Delete property form -->
                  <form action="{% url 'property_delete' property.id %}" method="POST" onsubmit="return confirm('Are you sure you want to delete this property?');">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
                  </form>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="7" class="text-center text-muted">No properties found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>

  <style>
/* Transparent table with visible borders */
.table-transparent {
  background: transparent !important;
  border-collapse: collapse;
  width: 100%;
  min-width: 700px; /* Prevent extreme shrinking */
}

.table-transparent th,
.table-transparent td {
  background: transparent !important;
  color: #000;
  border: 1px solid rgba(0,0,0,0.1);
  padding: 0.5rem 0.75rem;
  text-align: left;
  white-space: nowrap; /* Prevent text wrapping */
}

.table-transparent thead th {
  border-bottom: 2px solid rgba(0,0,0,0.15);
}

.table-hover tbody tr:hover {
  background-color: rgba(0, 102, 255, 0.05);
  transition: 0.2s;
}

/* Buttons styling */
.btn-primary, .btn-danger {
  font-size: 0.85rem;
  padding: 0.35rem 0.75rem;
}

/* Horizontal scroll on small screens */
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* Adjust font and padding on smaller screens */
@media (max-width: 768px) {

  /* Keep buttons in one row */
  td.d-flex.gap-1 {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    justify-content: flex-start !important;
    align-items: center !important;
    gap: 0.35rem !important;
    white-space: nowrap !important; /* VERY IMPORTANT */
  }

  /* Prevent table cells from breaking layout */
  .table-transparent td {
    white-space: nowrap !important;
  }
}
  </style>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

{% endblock %}
