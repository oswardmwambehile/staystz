{% extends 'customer/base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
<div class="container-fluid bg-light min-vh-100 p-0">

    <!-- Spinner Overlay -->
    <div id="spinner" class="d-none position-fixed w-100 vh-100 top-0 start-0 bg-white bg-opacity-75 d-flex align-items-center justify-content-center" style="z-index:9999;">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status"></div>
    </div>

    <!-- Navbar -->
    {% include 'customer/nav.html' %}

    <!-- Form Card -->
    <div class="d-flex align-items-center justify-content-center" style="min-height: 100vh;">
        <div class="card shadow-sm p-4 p-md-5" style="max-width: 450px; width: 90%; border-radius: 12px;">
            
            <h3 class="text-center mb-4 animated fadeIn" style="font-family: 'Montserrat', sans-serif; font-weight: 500; font-size: 1.8rem; line-height: 1.2;">
                Verify Your Email
            </h3>

            <div class="container mt-3">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} text-center">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>

            <p class="text-center text-muted mb-4">Enter the OTP sent to your email address.</p>

            <form id="verificationForm" action="" method="POST">
                {% csrf_token %}

                <div class="form-floating mb-4">
                    <input type="text" class="form-control" id="otp" name="otp_code" placeholder="Enter OTP" required>
                    <label for="otp">OTP</label>
                </div>

                <button type="submit" class="btn w-100 py-2 fw-bold" id="verifyBtn" style="background-color: #0b5ed7; color: white;">
                    <span id="btnText">Activate Account</span>
                    <span id="btnSpinner" class="spinner-border spinner-border-sm d-none ms-2" role="status"></span>
                </button>

                <p class="text-center mt-3">Didn't receive OTP? <a href="{% url 'resend-otp' %}">Resend</a></p>
            </form>
        </div>
    </div>
</div>

<!-- Styles -->
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f6f8fa;
    }

    .card {
        background-color: #fff;
        transition: all 0.3s ease;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: rgba(0, 0, 0, 0.25) 0px 10px 20px;
    }

    .form-floating>.form-control:focus~label {
        color: #0d6efd;
        font-weight: 600;
    }

    #verifyBtn {
        transition: background-color 0.3s ease, transform 0.2s ease;
    }
    #verifyBtn:hover {
        background-color: #0b5ed7;
        transform: translateY(-1px);
    }
</style>

<!-- Scripts -->
<script>
    const form = document.getElementById('verificationForm');
    const spinner = document.getElementById('spinner');
    const btnSpinner = document.getElementById('btnSpinner');
    const btnText = document.getElementById('btnText');

    form.addEventListener('submit', function() {
        spinner.classList.remove('d-none');
        btnSpinner.classList.remove('d-none');
        btnText.textContent = 'Verifying...';
    });
</script>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
{% endblock content %}
